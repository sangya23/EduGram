let workTitle = document.getElementById('work');
let breakTitle = document.getElementById('break');
let longBreakTitle = document.getElementById('longBreak');
let minutesDisplay = document.getElementById('minutes');
let secondsDisplay = document.getElementById('seconds');

let startBtn = document.getElementById('start');
let pauseBtn = document.getElementById('pause');
let resetBtn = document.getElementById('reset');

let workInput = document.getElementById('workInput');
let breakInput = document.getElementById('breakInput');
let longBreakInput = document.getElementById('longBreakInput');

let alarmSound = document.getElementById('alarmSound');

let timer;
let mode = "work";
let workSessions = 0;
let remainingMinutes;
let remainingSeconds;

function updateDisplay(mins, secs) {
  minutesDisplay.textContent = String(mins).padStart(2, '0');
  secondsDisplay.textContent = String(secs).padStart(2, '0');
}

function startTimer() {
  clearInterval(timer);
  startBtn.classList.add('hidden');
  resetBtn.classList.remove('hidden');

  let workTime = parseInt(workInput.value) || 25;
  let breakTime = parseInt(breakInput.value) || 5;
  let longBreakTime = parseInt(longBreakInput.value) || 15;

  let minutes, seconds;
  if (remainingMinutes !== undefined && remainingSeconds !== undefined) {
    minutes = remainingMinutes;
    seconds = remainingSeconds;
    remainingMinutes = undefined;
    remainingSeconds = undefined;
  } else {
    minutes = (mode === "work") ? workTime :
              (mode === "break") ? breakTime : longBreakTime;
    minutes--;
    seconds = 59;
  }

  timer = setInterval(() => {
    updateDisplay(minutes, seconds);
    seconds--;
    if (seconds < 0) {
      minutes--;
      seconds = 59;
    }
    if (minutes < 0) {
      clearInterval(timer);
      alarmSound.play(); // ðŸ”” Play alert sound
      if (mode === "work") {
        workSessions++;
        mode = (workSessions % 4 === 0) ? "longBreak" : "break";
      } else {
        mode = "work";
      }
      setActiveTab(mode);
      updateDisplay(
        mode === "work" ? workTime :
        mode === "break" ? breakTime : longBreakTime,
        0
      );
      startBtn.classList.remove('hidden');
      resetBtn.classList.add('hidden');
    }
  }, 1000);
}

function pauseTimer() {
  clearInterval(timer);
  remainingMinutes = parseInt(minutesDisplay.textContent);
  remainingSeconds = parseInt(secondsDisplay.textContent);
}

function resetTimer() {
  clearInterval(timer);
  mode = "work";
  setActiveTab("work");
  updateDisplay(parseInt(workInput.value) || 25, 0);
  startBtn.classList.remove('hidden');
  resetBtn.classList.add('hidden');
  alarmSound.pause();
  alarmSound.currentTime = 0;
}

function setActiveTab(tab) {
  workTitle.classList.remove('active');
  breakTitle.classList.remove('active');
  longBreakTitle.classList.remove('active');
  if (tab === "work") workTitle.classList.add('active');
  if (tab === "break") breakTitle.classList.add('active');
  if (tab === "longBreak") longBreakTitle.classList.add('active');
}

startBtn.addEventListener('click', startTimer);
pauseBtn.addEventListener('click', pauseTimer);
resetBtn.addEventListener('click', resetTimer);

workTitle.addEventListener('click', () => {
  clearInterval(timer);
  mode = "work";
  setActiveTab("work");
  updateDisplay(parseInt(workInput.value) || 25, 0);
  startBtn.classList.remove('hidden');
  resetBtn.classList.add('hidden');
});

breakTitle.addEventListener('click', () => {
  clearInterval(timer);
  mode = "break";
  setActiveTab("break");
  updateDisplay(parseInt(b